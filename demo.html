<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>kamo.js</title>
  </head>

  <body>
    <script src="kamo.js"></script>
    <script>
      var a = new kamo.Stream();
      var b = new kamo.Stream();
      var c = a.merge(b);
      c.subscribe(function(value) {
        console.log(value);
      });
      b.publish('b');
      a.publish('a');

      var d = new kamo.Stream();
      d.scan(0, function(currentValue, newValue) {
        return currentValue + newValue;
      }).subscribe(function(value) {
        console.log(value);
      });
      d.publish(1);
      d.publish(2);
      d.publish(3);

      var e = new kamo.Stream();
      e.filter(function(value) {
        return value >= 0;
      }).subscribe(function(value) {
        console.log(value);
      });
      e.publish(1);
      e.publish(-2);
      e.publish(3);

      var f = new kamo.Stream();
      f.map(function(value) {
        return value * 2;
      }).subscribe(function(value) {
        console.log(value);
      });
      f.publish(1);
      f.publish(2);

      var g = new kamo.Stream();
      var h = new kamo.Stream();
      g.combine(h, function(gValue, hValue) {
        return gValue + hValue;
      }).subscribe(function(value) {
        console.log(value);
      });
      g.publish(1);
      h.publish(2);
      g.publish(3);
      h.publish(4);

      var i = new kamo.Stream();
      var j = new kamo.Stream();
      i.sampledBy(j, function(iValue, jValue) {
        return iValue + jValue;
      }).subscribe(function(value) {
        console.log(value);
      });
      i.publish(1);
      j.publish(2);
      i.publish(3);
      j.publish(4);

      var k = new kamo.Stream();
      k.flatMap(function(value) {
        var eachStream = new kamo.Stream();
        window.setTimeout(
          function() {
            eachStream.publish(value * 2);
            eachStream.publish(value * 3);
          },
          1000
        );
        return eachStream;
      }).subscribe(function(value) {
        console.log(value);
      });
      k.publish(1);
      k.publish(2);

      var l = new kamo.Stream();
      l.flatMapLatest(function(value) {
        var eachStream = new kamo.Stream();
        window.setTimeout(
          function() {
            eachStream.publish(value * 2);
            eachStream.publish(value * 3);
          },
          1000
        );
        return eachStream;
      }).subscribe(function(value) {
        console.log(value);
      });
      l.publish(1);
      l.publish(2);
    </script>
  </body>
</html>
